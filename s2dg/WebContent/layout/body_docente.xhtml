<?xml version="1.0" encoding="ISO-8859-1"?>

<rich:panel xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a4j="http://richfaces.org/a4j"
	
	style="margin:0;border-width:0;padding:0px;">

	<table width="100%">
		<tr>
			<td width="200px">
			<div class="menu_disciplinas">
			<center><h:outputText styleClass="menu_disciplinas_titulo"
				value="Disciplinas Ministradas" /></center>
			<div class="menu_disciplinas_lista">

				<h:form>
				<ui:repeat value="#{fachada.turmasPorDisciplina}"
					var="disciplinaTurmas">
					<h:outputText value="#{disciplinaTurmas.disciplina.nome}" /><br/>
					<ui:repeat value="#{disciplinaTurmas.turmas}" var="turma">
						<a4j:commandLink styleClass="menu_disciplina_turma" action="#{fachada.setTurmaAtual(turma)}"
							value=":: Turma #{turma.numero}" reRender="titulo_disciplina,titulo_turma,tabela_notas,checkboxmedia,editorPlano" /><br/>
					</ui:repeat>
				</ui:repeat>
				</h:form>

			</div>
			</div>
			<br></br>

			<rich:calendar popup="false" locale="pt_BR" showFooter="false">
			</rich:calendar></td>

			<td style="padding-left: 20px;" height="100%">

			<div><rich:tabPanel switchType="client">
				<rich:tab label="Principal">
					<rich:panel styleClass="border_zero" >
						<h:outputText styleClass="body_titulo_disciplina" id="titulo_disciplina"
							value="Disciplina: #{fachada.turmaAtual.disciplina.codigo} - #{fachada.turmaAtual.disciplina.nome}" />
						<br />
						<h:outputText value="Turma #{fachada.turmaAtual.numero}" id="titulo_turma" />
						<br />
						<h:form>
							<rich:panel styleClass="border_zero" id="tabela_notas">
							<table class="dr-table rich-table" cellspacing="0"
								cellpadding="0" border="1" style="text-align: center;">
								<thead class="dr-table-thead">
									<tr class="dr-table-subheader rich-table-subheader">
										<th class="dr-table-subheadercell rich-table-subheadercell"
											scope="col">
										<div>Matrícula</div>
										</th>
										<th class="dr-table-subheadercell rich-table-subheadercell"
											scope="col">
										<div>Aluno</div>
										</th>
										<th class="dr-table-subheadercell rich-table-subheadercell"
											scope="col">
										<div>Número de Faltas</div>
										</th>
										<ui:repeat value="#{fachada.notasDaTurma}" var="nota">
											<th class="dr-table-subheadercell rich-table-subheadercell"
												scope="col">
											<center>
											<table style="text-align: center;">
												<tr>
													<td><h:outputText value="#{nota.nome}" /></td>
													<td><a4j:commandLink id="excluir" action="#{fachada.setNota(nota)}">
														<img alt="remover" src="img/del.png" />
														<rich:componentControl for="excluir_avaliacao" attachTo="excluir" operation="show" event="onclick" />
													</a4j:commandLink>
													</td>
												</tr>
												<tr>
													<td><h:outputText value="peso: #{nota.peso}" /></td>
													<td><a4j:commandLink action="#{fachada.setNotaParaEdicao(nota)}" reRender="criar_nota">
														<img alt="editar" src="img/edit.png"/>
													</a4j:commandLink></td>
												</tr>
											</table>
											</center>
											</th>
										</ui:repeat>
										<th class="dr-table-subheadercell rich-table-subheadercell"
											scope="col">
										<div>Média Final</div>
										</th>
									</tr>
								</thead>
								<tbody>
									<ui:repeat var="alunoTurma" value="#{fachada.alunoTurmas}" >
									<tr class="dr-table-firstrow rich-table-firstrow">
										<td class="dr-table-cell rich-table-cell action"><h:outputText
											value="#{alunoTurma.aluno.matricula}" /></td>
										<td class="dr-table-cell rich-table-cell action"><h:outputText
											value="#{alunoTurma.aluno.usuario.nome}" /></td>
										<td class="dr-table-cell rich-table-cell action"><h:inputText
											value="#{alunoTurma.faltas}" /></td>
										<ui:repeat value="#{fachada.notas}" var="nota">
											<td class="dr-table-cell rich-table-cell action"><h:inputText
												value="#{fachada.getAlunoTurmaNota(alunoTurma, nota).valorDaNota}" /></td>
										</ui:repeat>
										<td class="dr-table-cell rich-table-cell action"><h:inputText
											value="#{alunoTurma.media}" /></td>
									</tr>
									</ui:repeat>
								</tbody>
							</table>
							</rich:panel>
							<h:selectBooleanCheckbox id="checkboxmedia"
								value="#{fachada.turmaAtual.calcularMediaAutomaticamente}" />
							<h:outputText for="checkboxmedia"
								value="Calcular Média Automaticamente" />
							<a4j:commandButton styleClass="botao_salvar" type="submit"
								value="Salvar" action="#{fachada.persisteAlunoTurmas}"
								reRender="tabela_notas" />
						</h:form>
						
						<br/>
						<br/>
						<br/>
						<h:form>
						<rich:panel  width="230px" id="criar_nota" >
								<f:facet name="header">
									<h:outputText value="#{fachada.criarOuEditar?'Criar':'Editar'} Avaliação" />
								</f:facet>
								<table><tr><td>
								<h:outputText value="Nome: " /></td><td><h:inputText value="#{fachada.nota.nome}" /></td>
								<td><a4j:commandButton type="submit" rendered="#{not fachada.criarOuEditar}" reRender="criar_nota, tabela_notas"
								value="Atualizar" action="#{fachada.atualizarAvaliacao}"/></td></tr>
								<tr><td><h:outputText value="Peso:" /></td><td><rich:inputNumberSpinner minValue="1" cycled="false" value="#{fachada.nota.peso}" /></td>
								<td><a4j:commandButton styleClass="botao_criar" type="submit" rendered="#{fachada.criarOuEditar}"
								value="Criar" action="#{fachada.criarNota}"	reRender="tabela_notas, criar_nota, checkboxmedia" />
								<a4j:commandButton type="submit" rendered="#{not fachada.criarOuEditar}"
								value="Cancelar" action="#{fachada.cancelarEdicao}" reRender="criar_nota"/></td></tr>
								</table>
							</rich:panel>
						</h:form>
					</rich:panel>
				</rich:tab>
				<rich:tab label="Cronograma de Aulas">
					<ui:include src="/calendario.xhtml"/>
				</rich:tab>
				<rich:tab label="Plano de Curso">
					<h:form>
						<center>
						<rich:editor useSeamText="true" id="editorPlano" value="#{fachada.turmaAtual.planoDeCurso}"
									 theme="advanced" plugins="save,paste" language="pt" height="300" width="500" />
						<a4j:commandButton type="submit"
								value="Salvar" action="#{fachada.persistePlanoDeCurso}"/>
						</center>
					</h:form>
				</rich:tab>
			</rich:tabPanel></div>

			</td>
		</tr>
	</table>
	<rich:modalPanel id="excluir_avaliacao" width="485" height="100">
		<f:facet name="header">
			<h:panelGroup>
				<h:outputText value="Atenção!"/>
			</h:panelGroup>
		</f:facet>
		<center>
		<h:outputText
			value="Tem certeza que deseja excluir a avaliação e todas as suas notas?"/>
		<br />
		<h:form>
		<a4j:commandButton id="botaosim" action="#{fachada.excluiAvaliacao}" value="Sim" reRender="tabela_notas">
			<rich:componentControl for="excluir_avaliacao" attachTo="botaosim" operation="hide" event="onclick" />
		</a4j:commandButton>
		<a4j:commandButton id="botaonao" action="#{fachada.cancelaExclusao}" value="Não">
			<rich:componentControl for="excluir_avaliacao" attachTo="botaonao" operation="hide" event="onclick" />
		</a4j:commandButton>
		</h:form>
		</center>
	</rich:modalPanel>
</rich:panel>